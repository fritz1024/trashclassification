# 垃圾分类识别系统 - 完整开发方案

## 项目概述

基于MobileNetV2深度学习模型的智能垃圾分类识别系统，包含用户端和管理端，实现图片识别、数据统计、知识科普等功能。

**模型信息：**
- 模型架构：MobileNetV2（迁移学习 + 微调）
- 数据集：garbage265（265类垃圾）
- 准确率：80%
- 模型文件：best_model.pth

---

## 技术栈

### 后端
- **FastAPI** - Web框架
- **PyTorch** - 模型推理
- **SQLite** - 数据库
- **SQLAlchemy** - ORM数据库操作
- **Pydantic** - 数据验证
- **python-multipart** - 文件上传
- **Pillow** - 图片处理
- **torchvision** - 图像预处理
- **python-jose[cryptography]** - JWT token认证
- **passlib[bcrypt]** - 密码加密
- **uvicorn** - ASGI服务器

### 前端
- **Vue 3** - 前端框架（用户端 + 管理端）
- **Vite** - 构建工具
- **Axios** - HTTP请求
- **Element Plus** - UI组件库
- **ECharts** - 数据可视化
- **Vue Router** - 路由管理
- **Pinia** - 状态管理

### 其他
- **CORS Middleware** - 跨域处理
- **python-dotenv** - 环境变量管理

---

## 系统架构

```
trash-classify/
├── backend/                 # 后端
│   ├── app/
│   │   ├── api/            # API路由
│   │   ├── models/         # 数据库模型
│   │   ├── schemas/        # Pydantic模型
│   │   ├── services/       # 业务逻辑
│   │   ├── core/           # 核心配置
│   │   └── utils/          # 工具函数
│   ├── ml_models/          # 机器学习模型
│   ├── uploads/            # 上传文件存储
│   └── main.py             # 入口文件
├── frontend-user/          # 用户端前端
│   ├── src/
│   │   ├── views/          # 页面组件
│   │   ├── components/     # 公共组件
│   │   ├── router/         # 路由配置
│   │   ├── store/          # 状态管理
│   │   └── api/            # API接口
│   └── package.json
├── frontend-admin/         # 管理端前端
│   ├── src/
│   │   ├── views/
│   │   ├── components/
│   │   ├── router/
│   │   ├── store/
│   │   └── api/
│   └── package.json
├── best_model.pth          # 训练好的模型
└── README.md
```

---

## 功能模块设计

### 一、用户端功能

#### 1. 图片识别模块（核心）
**无需登录：**
- 单张图片上传识别
- 实时摄像头识别（不保存记录）
- 显示Top-3预测结果及置信度

**需要登录：**
- 批量图片识别
- 保存识别历史记录

#### 2. 识别历史模块（需登录）
- 查看个人识别历史
- 按时间、分类筛选
- 删除历史记录
- 重新识别历史图片

#### 3. 数据统计模块（需登录）
- 个人识别次数统计
- 各类垃圾识别占比（饼图）
- 识别趋势图（折线图）
- 识别准确率分析

#### 4. 知识科普模块（无需登录）
- 垃圾分类知识库
  - 可回收垃圾
  - 有害垃圾
  - 厨余垃圾
  - 其他垃圾
- 每种垃圾的处理方法
- 环保小贴士
- 搜索功能

#### 5. 用户反馈模块（需登录）
- 标注错误识别结果
- 提交正确分类
- 查看反馈处理状态

#### 6. 用户中心（需登录）
- 个人信息管理
- 修改密码
- 识别统计概览

### 二、管理端功能（需管理员权限）

#### 1. 数据管理
- 查看所有识别记录
- 按用户、时间、分类筛选
- 导出数据（CSV/Excel）
- 数据清理

#### 2. 用户管理
- 用户列表查看
- 用户状态管理（启用/禁用）
- 用户识别统计
- 重置用户密码

#### 3. 统计分析
- 全局数据统计
  - 总识别次数
  - 用户数量
  - 各类垃圾占比
- 系统使用趋势
- 用户活跃度分析
- 模型性能监控

#### 4. 反馈管理
- 查看用户反馈列表
- 处理错误标注
- 标记反馈状态
- 导出反馈数据用于模型迭代

#### 5. 知识库管理
- 添加/编辑/删除知识条目
- 分类管理
- 富文本编辑

#### 6. 模型管理
- 查看当前模型信息
- 模型版本管理
- 模型性能对比
- 模型切换（如有多个版本）

#### 7. 系统配置
- 系统参数配置
- 日志查看
- 数据备份

---

## 数据库设计

### 1. 用户表（users）
```sql
- id: 主键
- username: 用户名（唯一）
- password_hash: 密码哈希
- email: 邮箱（可选）
- role: 角色（user/admin）
- is_active: 是否激活
- created_at: 创建时间
- updated_at: 更新时间
```

### 2. 识别记录表（predictions）
```sql
- id: 主键
- user_id: 用户ID（外键，可为空表示游客）
- image_path: 图片路径
- predicted_class: 预测分类
- confidence: 置信度
- top3_results: Top3结果（JSON）
- is_correct: 是否正确（用户反馈）
- created_at: 创建时间
```

### 3. 反馈表（feedbacks）
```sql
- id: 主键
- user_id: 用户ID（外键）
- prediction_id: 识别记录ID（外键）
- correct_class: 正确分类
- comment: 备注
- status: 状态（pending/processed）
- created_at: 创建时间
- processed_at: 处理时间
```

### 4. 知识库表（knowledge）
```sql
- id: 主键
- category: 分类（可回收/有害/厨余/其他）
- title: 标题
- content: 内容
- examples: 示例（JSON）
- tips: 处理建议
- created_at: 创建时间
- updated_at: 更新时间
```

---

## 权限设计

### 用户角色
1. **游客（未登录）**
   - 单张图片识别
   - 实时摄像头识别（不保存）
   - 查看知识库

2. **普通用户（注册登录）**
   - 游客所有权限
   - 批量识别
   - 查看个人历史
   - 个人数据统计
   - 错误反馈

3. **管理员**
   - 用户端所有权限
   - 管理端所有功能

### 认证方式
- JWT Token认证
- Token有效期：7天
- 刷新Token机制

---

## API接口设计

### 认证相关
- `POST /api/auth/register` - 用户注册
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/logout` - 用户登出
- `GET /api/auth/me` - 获取当前用户信息

### 识别相关
- `POST /api/predict/single` - 单张图片识别
- `POST /api/predict/batch` - 批量识别
- `GET /api/predict/history` - 获取识别历史
- `DELETE /api/predict/{id}` - 删除识别记录

### 统计相关
- `GET /api/stats/user` - 用户统计
- `GET /api/stats/global` - 全局统计（管理员）
- `GET /api/stats/trend` - 趋势分析

### 反馈相关
- `POST /api/feedback` - 提交反馈
- `GET /api/feedback/list` - 获取反馈列表
- `PUT /api/feedback/{id}` - 处理反馈（管理员）

### 知识库相关
- `GET /api/knowledge/list` - 获取知识列表
- `GET /api/knowledge/{id}` - 获取知识详情
- `POST /api/knowledge` - 添加知识（管理员）
- `PUT /api/knowledge/{id}` - 更新知识（管理员）
- `DELETE /api/knowledge/{id}` - 删除知识（管理员）

### 用户管理（管理员）
- `GET /api/admin/users` - 获取用户列表
- `PUT /api/admin/users/{id}` - 更新用户状态
- `GET /api/admin/predictions` - 获取所有识别记录
- `GET /api/admin/export` - 导出数据

---

## 开发计划（8周）

### 第1周：项目搭建与基础开发
**目标：完成项目框架和基础功能**

- [ ] Day 1-2: 项目结构搭建
  - 创建后端项目结构
  - 创建前端项目（用户端 + 管理端）
  - 配置开发环境
  - 编写requirements.txt和package.json

- [ ] Day 3-4: 数据库设计与实现
  - 设计数据库表结构
  - 使用SQLAlchemy创建模型
  - 编写数据库初始化脚本
  - 创建默认管理员账号

- [ ] Day 5-7: 模型集成
  - 编写模型加载代码
  - 实现图片预处理
  - 实现推理接口
  - 测试模型推理性能

### 第2周：用户认证与核心识别功能
**目标：完成用户系统和基础识别功能**

- [ ] Day 1-3: 用户认证系统
  - 实现用户注册/登录API
  - JWT Token生成与验证
  - 权限中间件
  - 前端登录注册页面

- [ ] Day 4-7: 图片识别功能
  - 单张图片上传识别API
  - 批量识别API
  - 前端识别页面（上传组件）
  - 结果展示（Top-3 + 置信度）
  - 实时摄像头识别（前端）

### 第3周：用户端功能开发
**目标：完成用户端主要功能**

- [ ] Day 1-3: 识别历史功能
  - 历史记录API
  - 前端历史列表页面
  - 筛选和搜索功能
  - 删除和重新识别

- [ ] Day 4-5: 个人统计功能
  - 统计数据API
  - ECharts图表集成
  - 饼图、柱状图、折线图
  - 数据可视化页面

- [ ] Day 6-7: 知识科普模块
  - 知识库API
  - 知识列表和详情页面
  - 分类浏览
  - 搜索功能

### 第4周：用户端完善与优化
**目标：完善用户端功能和体验**

- [ ] Day 1-2: 用户反馈功能
  - 反馈提交API
  - 反馈表单页面
  - 反馈历史查看

- [ ] Day 3-4: 用户中心
  - 个人信息页面
  - 修改密码功能
  - 统计概览

- [ ] Day 5-7: 用户端优化
  - 响应式设计优化
  - 加载动画和提示
  - 错误处理
  - 性能优化

### 第5周：管理端基础功能
**目标：完成管理端核心功能**

- [ ] Day 1-2: 管理端框架搭建
  - 管理端布局（侧边栏 + 顶栏）
  - 路由配置
  - 权限验证

- [ ] Day 3-4: 数据管理
  - 识别记录管理页面
  - 数据筛选和搜索
  - 数据导出功能（CSV）

- [ ] Day 5-7: 用户管理
  - 用户列表页面
  - 用户状态管理
  - 用户详情和统计

### 第6周：管理端高级功能
**目标：完成管理端所有功能**

- [ ] Day 1-3: 统计分析
  - 全局统计Dashboard
  - 多维度数据分析
  - 趋势图表
  - 用户活跃度分析

- [ ] Day 4-5: 反馈管理
  - 反馈列表页面
  - 反馈处理功能
  - 状态更新

- [ ] Day 6-7: 知识库管理
  - 知识CRUD页面
  - 富文本编辑器集成
  - 分类管理

### 第7周：测试与优化
**目标：全面测试和性能优化**

- [ ] Day 1-2: 功能测试
  - 用户端功能测试
  - 管理端功能测试
  - 权限测试
  - 边界情况测试

- [ ] Day 3-4: 性能优化
  - 模型推理优化
  - 数据库查询优化
  - 前端加载优化
  - 图片压缩和缓存

- [ ] Day 5-6: 模型对比实验
  - 对比不同模型（如ResNet、EfficientNet）
  - 记录准确率、速度、模型大小
  - 生成对比报告和图表

- [ ] Day 7: Bug修复
  - 修复测试中发现的问题
  - 代码审查和重构

### 第8周：部署与文档
**目标：部署上线和完善文档**

- [ ] Day 1-2: 部署准备
  - Docker容器化（可选）
  - 云服务器部署（阿里云/腾讯云）
  - 域名配置（可选）

- [ ] Day 3-4: 文档编写
  - 用户使用手册
  - 管理员操作手册
  - API文档
  - 部署文档

- [ ] Day 5-6: 答辩准备
  - 准备演示数据
  - 制作演示PPT
  - 录制演示视频

- [ ] Day 7: 最终检查
  - 全面测试
  - 代码整理
  - 文档完善

---

## 论文大纲

### 第一章 绪论
1.1 研究背景
- 垃圾分类政策背景
- 人工智能在环保领域的应用

1.2 研究意义
- 理论意义
- 实际应用价值

1.3 国内外研究现状
- 图像识别技术发展
- 垃圾分类系统研究现状

1.4 研究内容与组织结构

### 第二章 相关技术介绍
2.1 深度学习基础
- 卷积神经网络（CNN）
- 迁移学习

2.2 MobileNetV2架构
- 网络结构分析
- 深度可分离卷积
- 倒残差结构

2.3 Web开发技术
- FastAPI框架
- Vue.js框架
- RESTful API设计

2.4 数据库技术
- SQLite数据库
- SQLAlchemy ORM

### 第三章 系统需求分析与设计
3.1 需求分析
- 功能需求
- 非功能需求

3.2 系统架构设计
- 总体架构
- 技术架构
- 部署架构

3.3 功能模块设计
- 用户端功能设计
- 管理端功能设计

3.4 数据库设计
- 数据库E-R图
- 表结构设计

3.5 接口设计
- API接口规范
- 数据交互流程

### 第四章 模型训练与优化
4.1 数据集介绍
- 数据集来源
- 数据分布分析
- 数据预处理

4.2 模型选择与对比
- 模型选型依据
- 多模型对比实验
- MobileNetV2优势分析

4.3 模型训练
- 训练环境配置
- 超参数设置
- 训练过程

4.4 模型评估
- 评估指标（准确率、召回率、F1-score）
- 混淆矩阵分析
- 错误案例分析

4.5 模型优化
- 数据增强
- 模型微调
- 性能优化

### 第五章 系统实现
5.1 开发环境
- 硬件环境
- 软件环境
- 开发工具

5.2 后端实现
- FastAPI框架搭建
- 模型推理服务
- 数据库操作
- 用户认证与权限
- 关键代码展示

5.3 前端实现
- Vue项目搭建
- 用户端界面实现
- 管理端界面实现
- 数据可视化实现
- 关键代码展示

5.4 系统集成
- 前后端联调
- 接口对接
- 部署配置

### 第六章 系统测试
6.1 测试环境

6.2 功能测试
- 用户端功能测试
- 管理端功能测试
- 测试用例与结果

6.3 性能测试
- 模型推理性能
- 接口响应时间
- 并发测试

6.4 用户体验测试
- 界面友好性
- 操作便捷性
- 用户反馈

### 第七章 总结与展望
7.1 工作总结
- 完成的工作
- 创新点

7.2 不足与改进
- 存在的问题
- 改进方向

7.3 未来展望
- 功能扩展
- 技术优化
- 应用前景

参考文献

附录
- 附录A：数据库表结构
- 附录B：API接口文档
- 附录C：关键代码

---

## 技术亮点与创新点

### 1. 模型方面
- 使用轻量级MobileNetV2，适合部署
- 迁移学习提高训练效率
- 多模型对比实验
- 模型性能优化

### 2. 系统方面
- 前后端分离架构
- 基于角色的访问控制（RBAC）
- 游客模式降低使用门槛
- 响应式设计，支持多端访问

### 3. 功能方面
- 实时摄像头识别
- 批量识别功能
- 数据可视化分析
- 用户反馈机制用于模型迭代
- 知识科普模块

### 4. 工程方面
- RESTful API设计
- JWT认证机制
- 数据导出功能
- 容器化部署（可选）

---

## 部署方案

### 开发环境
```bash
# 后端
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
uvicorn main:app --reload

# 前端用户端
cd frontend-user
npm install
npm run dev

# 前端管理端
cd frontend-admin
npm install
npm run dev
```

### 生产环境
1. **服务器选择**
   - 阿里云/腾讯云 ECS
   - 配置：2核4G（最低）
   - 系统：Ubuntu 20.04

2. **部署方式**
   - 方式一：传统部署（Nginx + Uvicorn）
   - 方式二：Docker容器化部署

3. **域名配置**（可选）
   - 用户端：www.trash-classify.com
   - 管理端：admin.trash-classify.com
   - API：api.trash-classify.com

---

## 注意事项

### 开发注意事项
1. **代码规范**
   - 遵循PEP 8（Python）
   - 遵循Vue风格指南
   - 添加必要注释

2. **安全性**
   - 密码加密存储
   - SQL注入防护
   - XSS防护
   - CSRF防护
   - 文件上传验证

3. **性能优化**
   - 图片压缩
   - 数据库索引
   - 接口缓存
   - 前端懒加载

4. **错误处理**
   - 统一错误码
   - 友好错误提示
   - 日志记录

### 论文注意事项
1. 图表清晰，数据真实
2. 代码截图规范
3. 引用文献格式正确
4. 查重率控制在15%以下

### 答辩注意事项
1. 准备演示环境（本地 + 线上）
2. 准备测试数据和图片
3. 熟悉系统所有功能
4. 准备常见问题回答
5. 控制演示时间（10-15分钟）

---

## 常见问题

### Q1: 模型推理速度慢怎么办？
- 使用GPU加速（如果有）
- 模型量化
- 图片预处理优化
- 异步处理

### Q2: 如何处理大量并发请求？
- 使用消息队列（Celery + Redis）
- 负载均衡
- 数据库连接池

### Q3: 前端如何调用摄像头？
- 使用浏览器MediaDevices API
- 需要HTTPS或localhost环境

### Q4: 如何导出Excel文件？
- 后端使用pandas或openpyxl
- 前端使用xlsx库

### Q5: 如何实现实时通知？
- WebSocket
- 或使用轮询（简单方案）

---

## 参考资源

### 学习资源
- FastAPI官方文档：https://fastapi.tiangolo.com/
- Vue 3官方文档：https://cn.vuejs.org/
- Element Plus文档：https://element-plus.org/
- PyTorch官方文档：https://pytorch.org/

### 开源项目参考
- FastAPI项目模板
- Vue Admin模板
- 图像分类项目

---

## 联系与支持

如有问题，请参考：
- 项目README.md
- API文档
- 开发文档

---

**文档版本：** v1.0
**最后更新：** 2025-12-22
**作者：** [你的名字]
