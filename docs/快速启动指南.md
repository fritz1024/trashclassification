# 快速启动指南

## 一键启动脚本

### 1. 后端启动脚本

创建 `start_backend.sh` (macOS/Linux) 或 `start_backend.bat` (Windows)

**macOS/Linux:**
```bash
#!/bin/bash
cd backend
source venv/bin/activate
python main.py
```

**Windows:**
```batch
@echo off
cd backend
call venv\Scripts\activate
python main.py
```

### 2. 前端启动脚本

创建 `start_frontend.sh` (macOS/Linux) 或 `start_frontend.bat` (Windows)

**macOS/Linux:**
```bash
#!/bin/bash

# 启动用户端
cd frontend-user
npm run dev &

# 启动管理端
cd ../frontend-admin
npm run dev &

echo "前端服务已启动"
echo "用户端: http://localhost:5173"
echo "管理端: http://localhost:5174"
```

**Windows:**
```batch
@echo off
start cmd /k "cd frontend-user && npm run dev"
start cmd /k "cd frontend-admin && npm run dev"
echo 前端服务已启动
echo 用户端: http://localhost:5173
echo 管理端: http://localhost:5174
```

## 首次运行步骤

### 第一步：安装后端依赖

```bash
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### 第二步：配置环境变量

```bash
cd backend
cp .env.example .env
# 编辑 .env 文件，修改必要的配置
```

### 第三步：初始化数据库

```bash
cd backend
python init_db.py
```

输出应该显示：
```
✓ 创建默认管理员账号: admin / admin123
✓ 添加初始知识库数据
数据库初始化完成！
```

### 第四步：启动后端

```bash
cd backend
python main.py
```

或使用 uvicorn：
```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

### 第五步：安装前端依赖

**用户端：**
```bash
cd frontend-user
npm install
```

**管理端：**
```bash
cd frontend-admin
npm install
```

### 第六步：启动前端

**用户端：**
```bash
cd frontend-user
npm run dev
```

**管理端：**
```bash
cd frontend-admin
npm run dev
```

## 访问地址

- **后端API**: http://localhost:8000
- **API文档**: http://localhost:8000/docs
- **用户端**: http://localhost:5173
- **管理端**: http://localhost:5174

## 默认账号

**管理员账号：**
- 用户名：`admin`
- 密码：`admin123`

## 测试流程

### 1. 测试用户端

1. 访问 http://localhost:5173
2. 点击"智能识别"
3. 上传一张垃圾图片
4. 查看识别结果

### 2. 测试用户注册登录

1. 点击右上角"注册"
2. 填写用户名和密码
3. 注册成功后登录
4. 测试批量识别、历史记录等功能

### 3. 测试管理端

1. 访问 http://localhost:5174
2. 使用管理员账号登录（admin / admin123）
3. 查看数据概览
4. 测试各个管理功能

## 常见启动问题

### 问题1: 端口被占用

**错误信息：** `Address already in use`

**解决方法：**
```bash
# 查找占用端口的进程
lsof -i :8000  # macOS/Linux
netstat -ano | findstr :8000  # Windows

# 杀死进程或更改端口
```

### 问题2: 模块未找到

**错误信息：** `ModuleNotFoundError: No module named 'xxx'`

**解决方法：**
```bash
# 确保虚拟环境已激活
source venv/bin/activate  # macOS/Linux
venv\Scripts\activate  # Windows

# 重新安装依赖
pip install -r requirements.txt
```

### 问题3: 数据库文件不存在

**错误信息：** `no such table: users`

**解决方法：**
```bash
cd backend
python init_db.py
```

### 问题4: 前端依赖安装失败

**解决方法：**
```bash
# 清除缓存
npm cache clean --force

# 删除 node_modules 和 package-lock.json
rm -rf node_modules package-lock.json

# 重新安装
npm install
```

### 问题5: 模型文件找不到

**错误信息：** `FileNotFoundError: best_model.pth`

**解决方法：**
- 确保 `best_model.pth` 在项目根目录
- 检查 `backend/.env` 中的 `MODEL_PATH` 配置
- 默认配置：`MODEL_PATH=../best_model.pth`

## 开发模式 vs 生产模式

### 开发模式（当前）

- 后端：`python main.py` 或 `uvicorn main:app --reload`
- 前端：`npm run dev`
- 特点：热重载、详细错误信息、调试工具

### 生产模式

- 后端：`gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker`
- 前端：`npm run build` 然后部署 dist 目录
- 特点：性能优化、压缩代码、生产级配置

## 下一步

1. 阅读 `开发方案.md` 了解详细的开发计划
2. 查看 `README.md` 了解完整的项目文档
3. 访问 http://localhost:8000/docs 查看API文档
4. 开始开发新功能！

## 需要帮助？

- 查看项目文档
- 检查日志输出
- 搜索错误信息
- 提交 Issue

祝开发顺利！
